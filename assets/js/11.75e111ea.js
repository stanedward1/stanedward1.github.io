(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{394:function(t,a,s){t.exports=s.p+"assets/img/rabbitmq_web.5e94b163.png"},416:function(t,a,s){"use strict";s.r(a);var r=s(2),n=Object(r.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[a("strong",[t._v("Table of Contents")]),t._v(" "),a("em",[t._v("generated with "),a("a",{attrs:{href:"https://github.com/thlorenz/doctoc",target:"_blank",rel:"noopener noreferrer"}},[t._v("DocToc"),a("OutboundLink")],1)])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#mq%E7%9A%84%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5"}},[t._v("MQ的相关概念")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#%E4%BB%80%E4%B9%88%E6%98%AFmq"}},[t._v("什么是MQ")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#mq%E7%9A%84%E4%BD%9C%E7%94%A8"}},[t._v("MQ的作用")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#%E6%B5%81%E9%87%8F%E6%B6%88%E5%B3%B0"}},[t._v("流量消峰")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#%E5%BA%94%E7%94%A8%E8%A7%A3%E8%80%A6"}},[t._v("应用解耦")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86"}},[t._v("异步处理")])])])]),t._v(" "),a("li",[a("a",{attrs:{href:"#mq%E7%9A%84%E5%88%86%E7%B1%BB"}},[t._v("MQ的分类")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#mq%E7%9A%84%E9%80%89%E6%8B%A9"}},[t._v("MQ的选择")])])])]),t._v(" "),a("li",[a("a",{attrs:{href:"#rabbitmq"}},[t._v("RabbitMQ")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#rabbitmq%E7%9A%84%E6%A6%82%E5%BF%B5"}},[t._v("RabbitMQ的概念")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#%E5%9B%9B%E5%A4%A7%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5"}},[t._v("四大核心概念")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#%E7%94%9F%E4%BA%A7%E8%80%85"}},[t._v("生产者")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#%E4%BA%A4%E6%8D%A2%E6%9C%BA"}},[t._v("交换机")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#%E9%98%9F%E5%88%97"}},[t._v("队列")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#%E6%B6%88%E8%B4%B9%E8%80%85"}},[t._v("消费者")])])])]),t._v(" "),a("li",[a("a",{attrs:{href:"#rabbitmq%E6%A0%B8%E5%BF%83%E9%83%A8%E5%88%86"}},[t._v("RabbitMQ核心部分")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#%E5%AE%89%E8%A3%85"}},[t._v("安装")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4"}},[t._v("相关命令")])])])])])])]),t._v(" "),a("h1",{attrs:{id:"mq的相关概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mq的相关概念"}},[t._v("#")]),t._v(" MQ的相关概念")]),t._v(" "),a("h2",{attrs:{id:"什么是mq"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是mq"}},[t._v("#")]),t._v(" 什么是MQ")]),t._v(" "),a("p",[t._v("字面意思，消息队列，符合FIFO，这是一种跨进程的通信机制，用于上下游传递消息。")]),t._v(" "),a("p",[t._v("使用了MQ之后，消息发送上游只需要依赖MQ，不需要依赖其他服务了。")]),t._v(" "),a("h2",{attrs:{id:"mq的作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mq的作用"}},[t._v("#")]),t._v(" MQ的作用")]),t._v(" "),a("h3",{attrs:{id:"流量消峰"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#流量消峰"}},[t._v("#")]),t._v(" 流量消峰")]),t._v(" "),a("p",[t._v("某个系统相同时间内支持10000人进行访问，此时超过10000人会引起服务器宕机等生产事故，那么这个时候，就需要引入MQ来进行流量消峰了。")]),t._v(" "),a("p",[t._v("原理大致是在用户访问系统服务器的中间过程，使用MQ来做缓冲。")]),t._v(" "),a("p",[t._v("结果：用户原本可能会访问不到系统，引入MQ之后，能保证系统的访问")]),t._v(" "),a("h3",{attrs:{id:"应用解耦"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应用解耦"}},[t._v("#")]),t._v(" 应用解耦")]),t._v(" "),a("p",[t._v("企业级项目中，常常有各个系统间的调用。有时候下游系统的调用出现问题，可能就造成了bug。")]),t._v(" "),a("p",[t._v("所以我们需要引入MQ来进行应用的解耦，当下游系统出现问题时，下游系统本应该要处理的进程被缓存在消息队列中，等待下游系统恢复正常之后，下游系统可以继续处理该进程，这样提升了系统的可用性。")]),t._v(" "),a("h3",{attrs:{id:"异步处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#异步处理"}},[t._v("#")]),t._v(" 异步处理")]),t._v(" "),a("p",[t._v("解决异步处理过程中一个服务等待另外一个服务完成任务的问题")]),t._v(" "),a("h2",{attrs:{id:"mq的分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mq的分类"}},[t._v("#")]),t._v(" MQ的分类")]),t._v(" "),a("ul",[a("li",[t._v("ActiveMQ")]),t._v(" "),a("li",[t._v("Kafka")]),t._v(" "),a("li",[t._v("RocketMQ")]),t._v(" "),a("li",[t._v("RabbitMQ")])]),t._v(" "),a("h2",{attrs:{id:"mq的选择"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mq的选择"}},[t._v("#")]),t._v(" MQ的选择")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("Kafka")]),t._v(" "),a("p",[t._v("主要特点是基于Pull的模式来处理消息消费，追求高吞吐量，适合产生大量数据的互联网服务的数据收集业务。如果有日志采集功能，首选Kafka")])]),t._v(" "),a("li",[a("p",[t._v("RocketMQ")]),t._v(" "),a("p",[t._v("阿里背景，为金融互联网领域而生。稳定性更值得信赖。业务场景在阿里双十一经历了考验")])]),t._v(" "),a("li",[a("p",[t._v("RabbitMQ")]),t._v(" "),a("p",[t._v("性能好，社区活跃度比较高。管理界面使用方便，功能也比较完备。")])])]),t._v(" "),a("h1",{attrs:{id:"rabbitmq"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rabbitmq"}},[t._v("#")]),t._v(" RabbitMQ")]),t._v(" "),a("h2",{attrs:{id:"rabbitmq的概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rabbitmq的概念"}},[t._v("#")]),t._v(" RabbitMQ的概念")]),t._v(" "),a("p",[t._v("负责接收，存储和转发消息数据")]),t._v(" "),a("h2",{attrs:{id:"四大核心概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四大核心概念"}},[t._v("#")]),t._v(" 四大核心概念")]),t._v(" "),a("h3",{attrs:{id:"生产者"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#生产者"}},[t._v("#")]),t._v(" 生产者")]),t._v(" "),a("p",[t._v("产生数据发送消息的程序是生产者")]),t._v(" "),a("h3",{attrs:{id:"交换机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#交换机"}},[t._v("#")]),t._v(" 交换机")]),t._v(" "),a("ul",[a("li",[t._v("接收来自生产者的消息")]),t._v(" "),a("li",[t._v("将消息推送到队列")])]),t._v(" "),a("p",[t._v("交换机的类型决定了它如何处理接收到的信息，比如是将消息推送到特定队列还是推送到多个队列，或者是把消息丢弃")]),t._v(" "),a("h3",{attrs:{id:"队列"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#队列"}},[t._v("#")]),t._v(" 队列")]),t._v(" "),a("p",[t._v("本质上是一个大的消息缓冲区")]),t._v(" "),a("p",[a("strong",[t._v("许多生产者可以将消息发送到一个队列")])]),t._v(" "),a("p",[a("strong",[t._v("许多消费者可以尝试从一个队列接收数据")])]),t._v(" "),a("h3",{attrs:{id:"消费者"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#消费者"}},[t._v("#")]),t._v(" 消费者")]),t._v(" "),a("p",[t._v("消费者大多时候是一个等待接收消息的程序")]),t._v(" "),a("p",[t._v("同一个应用程序既可以是生产者也可以是消费者")]),t._v(" "),a("h2",{attrs:{id:"rabbitmq核心部分"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rabbitmq核心部分"}},[t._v("#")]),t._v(" RabbitMQ核心部分")]),t._v(" "),a("ol",[a("li",[t._v("Hello World----简单模式")]),t._v(" "),a("li",[t._v("Work queues----工作模式")]),t._v(" "),a("li",[t._v("Publish/Subscribe----发布订阅模式")]),t._v(" "),a("li",[t._v("Routing----路由模式")]),t._v(" "),a("li",[t._v("Topics----主题模式")]),t._v(" "),a("li",[t._v("Publisher Confirms----发布确认模式")])]),t._v(" "),a("h2",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[t._v("#")]),t._v(" 安装")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.rabbitmq.com/install-debian.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档中关于下载的shell脚本"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/usr/bin/sh")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" gnupg apt-transport-https -y\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Team RabbitMQ's main signing key")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -1sLf "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://keys.openpgp.org/vks/v1/by-fingerprint/0A9AF2115F4687BD29803A206B73A36E6026DFCA"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" gpg --dearmor "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tee")]),t._v(" /usr/share/keyrings/com.rabbitmq.team.gpg "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /dev/null\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Launchpad PPA that provides modern Erlang releases")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -1sLf "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://keyserver.ubuntu.com/pks/lookup?op=get&search=0xf77f1eda57ebb1cc"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" gpg --dearmor "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tee")]),t._v(" /usr/share/keyrings/net.launchpad.ppa.rabbitmq.erlang.gpg "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /dev/null\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## PackageCloud RabbitMQ repository")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -1sLf "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://packagecloud.io/rabbitmq/rabbitmq-server/gpgkey"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" gpg --dearmor "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tee")]),t._v(" /usr/share/keyrings/io.packagecloud.rabbitmq.gpg "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /dev/null\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Add apt repositories maintained by Team RabbitMQ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tee")]),t._v(" /etc/apt/sources.list.d/rabbitmq.list "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('EOF\n## Provides modern Erlang/OTP releases\n##\n## "bionic" as distribution name should work for any reasonably recent Ubuntu or Debian release.\n## See the release to distribution mapping table in RabbitMQ doc guides to learn more.\ndeb [signed-by=/usr/share/keyrings/net.launchpad.ppa.rabbitmq.erlang.gpg] http://ppa.launchpad.net/rabbitmq/rabbitmq-erlang/ubuntu bionic main\ndeb-src [signed-by=/usr/share/keyrings/net.launchpad.ppa.rabbitmq.erlang.gpg] http://ppa.launchpad.net/rabbitmq/rabbitmq-erlang/ubuntu bionic main\n\n## Provides RabbitMQ\n##\n## "bionic" as distribution name should work for any reasonably recent Ubuntu or Debian release.\n## See the release to distribution mapping table in RabbitMQ doc guides to learn more.\ndeb [signed-by=/usr/share/keyrings/io.packagecloud.rabbitmq.gpg] https://packagecloud.io/rabbitmq/rabbitmq-server/ubuntu/ bionic main\ndeb-src [signed-by=/usr/share/keyrings/io.packagecloud.rabbitmq.gpg] https://packagecloud.io/rabbitmq/rabbitmq-server/ubuntu/ bionic main\nEOF')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Update package indices")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" update -y\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Install Erlang packages")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y erlang-base "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n                        erlang-asn1 erlang-crypto erlang-eldap erlang-ftp erlang-inets "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n                        erlang-mnesia erlang-os-mon erlang-parsetools erlang-public-key "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n                        erlang-runtime-tools erlang-snmp erlang-ssl "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n                        erlang-syntax-tools erlang-tftp erlang-tools erlang-xmerl\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Install rabbitmq-server and its dependencies")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" rabbitmq-server -y --fix-missing\n")])])]),a("h3",{attrs:{id:"相关命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#相关命令"}},[t._v("#")]),t._v(" 相关命令")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl start rabbitmq-server\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl status rabbitmq-server\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl stop rabbitmq-server\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" update\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" sysv-rc-conf\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" sysv-rc-conf\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" sysv-rc-conf rabbitmq-server on\n  sysv-rc-conf -list\n  rabbitmq-plugins version\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" rabbitmq-plugins "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v(" rabbitmq_management\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" rabbitmqctl add_user admin password\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" rabbitmqctl set_user_tags admin administrator\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" rabbitmqctl set_permissions -p / admin "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('".*"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('".*"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('".*"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" rabbitmqctl list_users\n")])])]),a("p",[t._v("port：15672 开启防火墙\n"),a("img",{attrs:{src:s(394),alt:"rabbit_management_web"}})])])}),[],!1,null,null,null);a.default=n.exports}}]);